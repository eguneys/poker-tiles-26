var e=Object.defineProperty,t=t=>{let n={};for(var r in t)e(n,r,{get:t[r],enumerable:!0});return n};(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();function n(e,t,n){let r=1e3/60,i=performance.now(),a=0;function o(s){requestAnimationFrame(o);let c=Math.min(s-i,25);for(i=s,a+=c;a>=r;)e(r),a-=r;t(a/r),n?.()}requestAnimationFrame(o)}function r(e,t){let n=e=>{if(e.clientX||e.clientX===0)return[e.clientX,e.clientY]},r=e=>{let[t,r]=n(e)??[0,0];return[(t-c.left)/c.width,(r-c.top)/c.height]};function i(n){e.setPointerCapture(n.pointerId);let i=r(n);t.on_down(i)}function a(e){let n=r(e);t.on_up(n)}function o(e){let n=r(e);t.on_move(n)}let s=e.getContext(`2d`),c;l();function l(){c=e.getBoundingClientRect(),s.imageSmoothingEnabled=!1}function u(){l()}e.addEventListener(`pointerdown`,i,{passive:!1}),e.addEventListener(`pointermove`,o,{passive:!1}),document.addEventListener(`pointerup`,a),new ResizeObserver(l).observe(e),document.addEventListener(`scroll`,u,{capture:!0,passive:!0}),window.addEventListener(`resize`,u,{passive:!0})}function i(e){let t=[0,0],n,i,a,o,s=!1,c=0;function l(t){return[t[0]*e.width,t[1]*e.height]}return r(e,{on_down(e){e=l(e),i=void 0,n=e,a=e,s=!1},on_up(e){e=l(e),n=void 0,i=e},on_move(e){if(e=l(e),t=e,n){let t=n[0]-e[0],r=n[1]-e[1];t*t+r*r>64&&(s=!0)}}}),{get is_hovering(){return t},get is_down(){return n},get is_up(){return i},get is_just_down(){return a},get is_double_click(){return o},get has_moved_after_last_down(){return s},update(e){o=void 0,a&&c>0&&(o=a,c=0),c-=e,a=void 0,i=void 0}}}let a,o;function s(){let e=document.createElement(`canvas`);return e.width=1920,e.height=1080,o=e.getContext(`2d`),a=i(e),e}const c={black:`#000000`,darkblue:`#1D2B53`,darkred:`#7E2553`,darkgreen:`#008751`,brown:`#AB5236`,gray:`#5F574F`,lightgray:`#C2C3C7`,white:`#FFF1E8`,red:`#FF004D`,orange:`#FFA300`,yellow:`#FFEC27`,green:`#00E436`,blue:`#29ADFF`,purple:`#83769C`,pink:`#FF77A8`,sand:`#FFCCAA`},l={white:`#fbf8fd`,light:`#a1a9d1`,blue:`#007fff`,darkblue:`#24256f`,black:`#141218`,purple:`#5f0e52`,red:`#fd1a43`,pink:`#ffb16c`,yellow:`#fede5b`,green:`#74ead6`};function u(e=0,t=0){return{x:e,y:t}}function d(e,t){return{x:e.x+t.x,y:e.y+t.y}}function f(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ee(e,t){return{x:e.x*t,y:e.y*t}}var p={duration:.2,easing:e=>e},m={stiffness:150,damping:18},h={speed:1},te={amplitude:0,frequency:3,bias:0},g=class{value;velocity=0;baseValue=0;mode=`hold`;time=0;timeInMode=0;tweenStart=0;tweenTarget=0;tweenConfig=p;springTarget=0;springConfig=m;followTarget=0;followConfig=h;swayEnabled=!1;swayConfig={...te};lastSwayValue=0;swayFade=0;constructor(e=0){this.baseValue=e,this.value=this.baseValue}hold(){return this.mode=`hold`,this.timeInMode=0,this.velocity=0,this}tweenTo(e,t){return this.mode=`tween`,this.tweenConfig={...p,...t},this.tweenStart=this.value,this.tweenTarget=e,this.timeInMode=0,this}springTo(e,t){return this.mode=`spring`,this.springConfig={...m,...t},this.springTarget=e,this.timeInMode=0,this}followTo(e,t){return this.mode=`follow`,this.followConfig={...h,...t},this.followTarget=e,this}swayTo(e){return this.swayConfig={...this.swayConfig,...e},this.swayEnabled=!0,this}disableSway(){return this.swayEnabled=!1,this}update(e){switch(this.time+=e,this.timeInMode+=e,this.mode){case`hold`:break;case`tween`:{let e=Math.min(this.timeInMode/this.tweenConfig.duration,1),t=this.tweenConfig.easing(e);this.baseValue=this.tweenStart+(this.tweenTarget-this.tweenStart)*t;break}case`spring`:{let{stiffness:t,damping:n}=this.springConfig,r=-t*(this.baseValue-this.springTarget)-n*this.velocity;this.velocity+=r*e,this.baseValue+=this.velocity*e;break}case`follow`:{let{speed:t}=this.followConfig,n=1-(1-t)**e;this.baseValue+=(this.followTarget-this.baseValue)*n;break}}if(this.swayEnabled&&this.swayConfig){this.swayFade=Math.min(this.swayFade+e*8,1);let t=(Math.sin(this.time*this.swayConfig.frequency+0)*this.swayConfig.amplitude+this.swayConfig.bias-this.lastSwayValue)*this.swayFade;this.baseValue+=t,this.lastSwayValue+=t}else this.swayFade=0;this.value=this.baseValue}},_={xy:u(150,150),wh:u(880,880)};ie(),u(1500,100),u(300,300),u(1500,400),u(300,300),u(1500,700),u(300,300);var ne={xy:u(1200,140),wh:u(200,400)},re={xy:u(1200,590),wh:u(200,400)};y(ne),y(re),new g().swayTo({amplitude:.1,frequency:1.9,bias:.03}),new g().swayTo({amplitude:.1,frequency:2.1,bias:-.03}),new g().swayTo({amplitude:.05,frequency:2.5,bias:0}),new g,new g,new g,new g(300*1),new g,new g(300*2);var v=()=>({buffer:[{color:`empty`,channel:new g},{color:`empty`,channel:new g}],i:0});v(),v(),v(),v(),v(),v(),v(),v(),v(),new g,ae(),b(),b();function y(e){let t=[];for(let n=0;n<2;n++)for(let r=0;r<3;r++)t.push({xy:d(e.xy,u(n*100,r*100)),wh:u(80,80)});return t}function ie(){let e=[];for(let t=0;t<8;t++){let n=[];for(let e=0;e<8;e++)n.push({xy:d(_.xy,u(t*110,e*110)),wh:u(110,110)});e.push(n)}return e}function ae(){let e=[];for(let t=0;t<8;t++){let t=[];for(let e=0;e<8;e++)t.push(new g);e.push(t)}return e}function b(){let e=[];for(let t=0;t<8;t++){let t=[];for(let e=0;e<8;e++)t.push(null);e.push(t)}return e}const x=e=>e>>3,S=e=>e&7,C=(e,t)=>0<=e&&e<8&&0<=t&&t<8?e+8*t:void 0;var w=e=>(e-=e>>>1&1431655765,e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),T=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),E=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,T(e)),D=class e{lo;hi;constructor(e,t){this.lo=e|0,this.hi=t|0}static fromSquare(t){return t>=32?new e(0,1<<t-32):new e(1<<t,0)}static fromRank(t){return new e(255,0).shl64(8*t)}static fromFile(t){return new e(16843009<<t,16843009<<t)}static empty(){return new e(0,0)}static full(){return new e(4294967295,4294967295)}static corners(){return new e(129,2164260864)}static center(){return new e(402653184,24)}static backranks(){return new e(255,4278190080)}static backrank(t){return t===`white`?new e(255,0):new e(0,4278190080)}static lightSquares(){return new e(1437226410,1437226410)}static darkSquares(){return new e(2857740885,2857740885)}complement(){return new e(~this.lo,~this.hi)}xor(t){return new e(this.lo^t.lo,this.hi^t.hi)}union(t){return new e(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new e(this.lo&t.lo,this.hi&t.hi)}diff(t){return new e(this.lo&~t.lo,this.hi&~t.hi)}intersects(e){return this.intersect(e).nonEmpty()}isDisjoint(e){return this.intersect(e).isEmpty()}supersetOf(e){return e.diff(this).isEmpty()}subsetOf(e){return this.diff(e).isEmpty()}shr64(t){return t>=64?e.empty():t>=32?new e(this.hi>>>t-32,0):t>0?new e(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?e.empty():t>=32?new e(0,this.lo<<t-32):t>0?new e(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new e(T(this.hi),T(this.lo))}rbit64(){return new e(E(this.hi),E(this.lo))}minus64(t){let n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new e(n,this.hi-(t.hi+r))}equals(e){return this.lo===e.lo&&this.hi===e.hi}size(){return w(this.lo)+w(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(e){return(e>=32?this.hi&1<<e-32:this.lo&1<<e)!=0}set(e,t){return t?this.with(e):this.without(e)}with(t){return t>=32?new e(this.lo,this.hi|1<<t-32):new e(this.lo|1<<t,this.hi)}without(t){return t>=32?new e(this.lo,this.hi&~(1<<t-32)):new e(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new e(this.lo,this.hi^1<<t-32):new e(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo===0?new e(0,this.hi&this.hi-1):new e(this.lo&this.lo-1,this.hi)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!=0||(this.hi&this.hi-1)!=0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let e=this.lo,t=this.hi;for(;e!==0;){let t=31-Math.clz32(e&-e);e^=1<<t,yield t}for(;t!==0;){let e=31-Math.clz32(t&-t);t^=1<<e,yield 32+e}}*reversed(){let e=this.lo,t=this.hi;for(;t!==0;){let e=31-Math.clz32(t);t^=1<<e,yield 32+e}for(;e!==0;){let t=31-Math.clz32(e);e^=1<<t,yield t}}},O=(e,t)=>{let n=D.empty();for(let r of t){let t=e+r;0<=t&&t<64&&Math.abs(S(e)-S(t))<=2&&(n=n.with(t))}return n},k=e=>{let t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},oe=k(e=>O(e,[-9,-8,-7,-1,1,7,8,9])),se=k(e=>O(e,[-17,-15,-10,-6,6,10,15,17])),ce={white:k(e=>O(e,[7,9])),black:k(e=>O(e,[-7,-9]))};const le=e=>oe[e],ue=e=>se[e],de=(e,t)=>ce[e][t];var fe=k(e=>D.fromFile(S(e)).without(e)),pe=k(e=>D.fromRank(x(e)).without(e)),me=k(e=>{let t=new D(134480385,2151686160),n=8*(x(e)-S(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),he=k(e=>{let t=new D(270549120,16909320),n=8*(x(e)+S(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),A=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},ge=(e,t)=>A(D.fromSquare(e),fe[e],t),_e=(e,t)=>{let n=pe[e],r=t.intersect(n),i=r.rbit64();return r=r.minus64(D.fromSquare(e)),i=i.minus64(D.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)};const j=(e,t)=>{let n=D.fromSquare(e);return A(n,me[e],t).xor(A(n,he[e],t))},M=(e,t)=>ge(e,t).xor(_e(e,t)),ve=(e,t)=>j(e,t).xor(M(e,t)),ye=(e,t,n)=>{switch(e.role){case`pawn`:return de(e.color,t);case`knight`:return ue(t);case`bishop`:return j(t,n);case`rook`:return M(t,n);case`queen`:return ve(t,n);case`king`:return le(t)}};function N(e,t){let{x:n,y:r}=e,i=t.get(n),a=t.get(r);if(S(i)===S(a))return i<a?3:7;if(x(i)===x(a))return i<a?1:5;let o=S(i)-S(a),s=x(i)-x(a);if(Math.abs(o)===Math.abs(s))return o<0?s<0?2:8:s<0?4:6;if(o===2){if(s===1)return 11;if(s===-1)return 12}else if(o===-2){if(s===1)return 13;if(s===-1)return 14}else if(o===1){if(s===2)return 15;if(s===-2)return 16}else if(o===-1){if(s===2)return 17;if(s===-2)return 18}return 0}function P(e){let t=be(e),n=[];for(let[r,i]of e.entries()){let a=ye(xe(r),i,t);a=a.intersect(t);for(let t of a){let[i]=[...e.entries()].find(e=>e[1]===t);n.push({x:r,y:i})}}return n}function be(e){let t=D.empty();for(let n of e.values())t=t.set(n,!0);return t}function xe(e){switch(e[0]){case`P`:return{color:`white`,role:`pawn`};case`p`:return{color:`black`,role:`pawn`};case`b`:return{color:`black`,role:`bishop`};case`n`:return{color:`black`,role:`knight`};case`r`:return{color:`black`,role:`rook`};case`q`:return{color:`black`,role:`queen`};case`k`:return{color:`black`,role:`king`}}}function F(e){e=e.split(` `)[0];let t=new Map,n=0,r=0,i=0,a=0,o=0,s=0,c=0,l=e=>{switch(e){case`P`:return`P`+ ++n;case`p`:return`p`+ ++r;case`B`:case`b`:return`b`+ ++a;case`N`:case`n`:return`n`+ ++s;case`R`:case`r`:return`r`+ ++o;case`Q`:case`q`:return`q`+ ++c;case`K`:case`k`:return`k`+ ++i}},u=7;for(let n of e.split(`/`)){let e=0;for(let r of n){let n=l(r);if(n!==void 0){let r=C(e,u);r!==void 0&&t.set(n,r),e+=1}else{e+=parseInt(r);continue}}--u}return t}var I=t({_init:()=>Se,_render:()=>Ee,_update:()=>Ce,next_scene:()=>Ne}),L={xy:u(300,60),wh:u(960,960)};Fe(L);var R,z,B,V,H,U;function W(e){let t=()=>Math.floor(Math.random()*64);V=[];let n=[];for(let r of e.keys()){let e=t();for(;n.includes(e);)e=t();n.push(e),V.push({pieces:r,xy:{x:new g(500),y:new g(500)},sq_base:e})}B=P(e),H=B.map(e=>({data:e,piece:V.find(t=>t.pieces===e.x),xy:{x:new g(0),y:new g(0)},stick:0})),U=[]}function Se(){W(F(`4k3/4b3/5pp1/3KP2p/1p5P/4B1P1/1P6/8 w - - 1 44`)),W(F(`4rk2/3q1p2/2pp1Ppp/p1p5/2P2bN1/1P2Q3/P4PPP/4RK2 w - - 2 28`)),z=0,R={xy:u(0,0),wh:{x:40,y:40},follow:{x:new g().swayTo({amplitude:-8,frequency:13,bias:0}),y:new g().swayTo({amplitude:-8,frequency:13,bias:0})}},o.lineCap=`round`,o.lineJoin=`round`}function Ce(e){if(we(e),z+=e/1e3,R.follow.x.followTo(a.is_hovering[0]),R.follow.y.followTo(a.is_hovering[1]),R.follow.x.update(e/1e3),R.follow.y.update(e/1e3),R.xy=u(R.follow.x.value,R.follow.y.value),R.drag&&a.has_moved_after_last_down&&(R.drag.piece.xy.x.followTo(R.xy.x-R.drag.decay.x),R.drag.piece.xy.y.followTo(R.xy.y-R.drag.decay.y)),R.sq=Y(R.xy),a.is_just_down){let e=R.sq;if(e!==void 0){let t=V.find(t=>t.sq===e);t&&(R.drag={decay:f(R.xy,{x:t.xy.x.value,y:t.xy.y.value}),piece:t})}}for(let t of V)Te(t,e);for(let t of H)G(t,H.filter(e=>e.stick===0).indexOf(t),e);for(let t of U)G(t,0,e);a.is_up&&(R.drag&&=void 0)}function we(e){let t=Le(),n=P(t),r=H;r.forEach(e=>e.stick=0);for(let e of n){let n=r.find(t=>t.data.x===e.x&&t.data.y===e.y);n&&(n.stick=N(e,t))}let i=n.filter(e=>!B.find(t=>t.x===e.x&&t.y===e.y)),a=U;for(let e of i){let n=a.find(t=>t.data.x===e.x&&t.data.y===e.y),r=N(e,t);n&&(n.stick=r),n||a.push({data:e,piece:V.find(t=>t.pieces===e.x),xy:{x:new g(0),y:new g(0)},stick:N(e,t)})}let o=a.filter(e=>!i.find(t=>t.x===e.data.x&&t.y===e.data.y));U=a.filter(e=>!o.includes(e))}function Te(e,t){e.sq=Y(u(e.xy.x.value,e.xy.y.value));let n=Ie(e.sq_base);R.drag?.piece===e?a.is_up&&e.sq!==void 0&&(e.sq_base=e.sq):(e.xy.x.springTo(n.x,{stiffness:600,damping:17}),e.xy.y.springTo(n.y,{stiffness:600,damping:17})),e.xy.x.update(t/1e3),e.xy.y.update(t/1e3)}function G(e,t,n){if(e.stick===0){let n=Math.sin(z*.5*Math.PI*2+t*Math.PI*.25)*80,r=Math.cos(z*.5*Math.PI*2+t*Math.PI*.25)*80;e.xy.x.followTo(r,{speed:.999}),e.xy.y.followTo(n,{speed:.999})}else{let[t,n]=Pe[e.stick];e.xy.x.springTo(t*37),e.xy.y.springTo(n*37)}e.xy.x.update(n/1e3),e.xy.y.update(n/1e3)}function Ee(){o.fillStyle=c.darkblue,o.fillRect(0,0,1920,1080),je();for(let e of V)De(e);Me(R.xy.x,R.xy.y)}function De(e){let t=e.xy.x.value,n=e.xy.y.value;Ae(t,n,e.pieces);for(let e of H){let t=e.piece.xy.x.value,n=e.piece.xy.y.value;t+=e.xy.x.value,n+=e.xy.y.value,ke(t,n,e.data.y,e.stick)}for(let e of U){let t=e.piece.xy.x.value,n=e.piece.xy.y.value;t+=e.xy.x.value,n+=e.xy.y.value,Oe(t,n,e.data.y,e.stick)}}function Oe(e,t,n,r){o.lineWidth=4,o.strokeStyle=c.red,o.beginPath(),o.roundRect(e-15,t-15,30,30,6),o.stroke(),o.fill(),q(e,t,n)}function ke(e,t,n,r){o.lineWidth=4,o.strokeStyle=r===0?c.red:c.green,o.beginPath(),o.roundRect(e-15,t-15,30,30,6),o.stroke(),o.fill(),q(e,t,n)}var K=[l.yellow,l.white,l.blue,l.pink,l.green,l.light,l.black,l.purple,l.darkblue];function q(e,t,n){o.strokeStyle=K[parseInt(n[1])-1],n[0]===`r`&&(o.beginPath(),o.moveTo(e-10,t),o.lineTo(e+10,t),o.moveTo(e,t-10),o.lineTo(e,t+10),o.stroke()),n[0]===`b`&&(o.beginPath(),o.moveTo(e-10,t-10),o.lineTo(e+10,t+10),o.moveTo(e-10,t+10),o.lineTo(e+10,t-10),o.stroke()),n[0]===`P`&&(o.beginPath(),o.moveTo(e-10,t-10),o.lineTo(e,t),o.moveTo(e+10,t-10),o.lineTo(e,t),o.lineTo(e,t+5),o.stroke()),n[0]===`p`&&(o.beginPath(),o.moveTo(e-10,t+10),o.lineTo(e,t),o.moveTo(e+10,t+10),o.lineTo(e,t),o.lineTo(e,t-5),o.stroke()),n[0]===`k`&&(o.beginPath(),o.roundRect(e-10,t-10,20,20,4),o.stroke()),n[0]===`n`&&(o.beginPath(),o.moveTo(e-5,t-10),o.lineTo(e-5,t+10),o.lineTo(e+5,t+10),o.stroke()),n[0]===`q`&&(o.beginPath(),o.moveTo(e-10,t-10),o.lineTo(e+10,t+10),o.moveTo(e-10,t+10),o.lineTo(e+10,t-10),o.moveTo(e-12,t),o.lineTo(e+12,t),o.moveTo(e,t-12),o.lineTo(e,t+12),o.stroke())}function Ae(e,t,n){o.strokeStyle=K[parseInt(n[1])-1],o.lineWidth=9,n[0]===`b`&&(o.beginPath(),o.moveTo(e-20,t-20),o.lineTo(e+20,t+20),o.moveTo(e-20,t+20),o.lineTo(e+20,t-20),o.stroke()),n[0]===`r`&&(o.beginPath(),o.moveTo(e-25,t),o.lineTo(e+25,t),o.moveTo(e,t-25),o.lineTo(e,t+25),o.stroke()),n[0]===`P`&&(o.beginPath(),o.moveTo(e-20,t-20),o.lineTo(e,t),o.moveTo(e+20,t-20),o.lineTo(e,t),o.lineTo(e,t+10),o.stroke()),n[0]===`p`&&(o.beginPath(),o.moveTo(e-20,t+20),o.lineTo(e,t),o.moveTo(e+20,t+20),o.lineTo(e,t),o.lineTo(e,t-10),o.stroke()),n[0]===`k`&&(o.beginPath(),o.roundRect(e-27,t-27,54,54,10),o.stroke()),n[0]===`n`&&(o.beginPath(),o.moveTo(e-10,t-20),o.lineTo(e-10,t+20),o.lineTo(e+10,t+20),o.stroke()),n[0]===`q`&&(o.beginPath(),o.moveTo(e-20,t-20),o.lineTo(e+20,t+20),o.moveTo(e-20,t+20),o.lineTo(e+20,t-20),o.moveTo(e-22,t),o.lineTo(e+22,t),o.moveTo(e,t-22),o.lineTo(e,t+22),o.stroke())}function je(){let e,t;e=300,t=60,o.lineWidth=4,o.strokeStyle=c.pink,o.beginPath();for(let n=0;n<8;n++)for(let r=0;r<8;r++)(n+r)%2!=0&&o.roundRect(e+n*120+8,t+r*120+8,104,104,16);o.stroke(),o.strokeStyle=c.blue,o.beginPath();for(let n=0;n<8;n++)for(let r=0;r<8;r++)(n+r)%2!=1&&o.roundRect(e+n*120,t+r*120,120,120,16);o.stroke(),o.strokeStyle=c.darkblue,o.beginPath();for(let n=0;n<8;n++)for(let r=0;r<8;r++)(n+r)%2!=0&&o.roundRect(e+n*120+8+4,t+r*120+8+4,96,96,16);o.stroke(),o.strokeStyle=c.darkblue,o.beginPath();for(let n=0;n<8;n++)for(let r=0;r<8;r++)(n+r)%2!=1&&o.roundRect(e+n*120+4,t+r*120+4,112,112,16);o.stroke()}function Me(e,t){o.lineWidth=20,o.strokeStyle=c.black,o.beginPath(),o.moveTo(e+40,t+3),o.lineTo(e+0,t+0),o.lineTo(e+3,t+40),o.stroke()}var J=void 0;function Ne(){let e=J;if(e!==void 0)return J=void 0,e}var Pe=[[0,0],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[0,0],[0,0],[-1,.6],[-1,-.6],[1,.6],[1,-.6],[-.6,1],[-.6,-1],[.6,1],[.6,-1]];function Fe(e){let t=[];for(let n=0;n<8;n++){let r=[];for(let t=0;t<8;t++)r.push({xy:u(e.xy.x+n*120,e.xy.y+t*120),wh:u(120,120)});t.push(r)}return t}function Ie(e){let t=S(e),n=7-x(e);return d(d(u(t/8*L.wh.x,n/8*L.wh.y),L.xy),ee(L.wh,1/16))}function Y(e){let t=f(e,L.xy),n=L.wh.x,r=Math.floor(t.x/n*8),i=Math.floor(t.y/n*8);if(!(r<0||r>7||i<0||i>7))return C(r,7-i)}function Le(){let e=new Map;for(let t of V)t.sq!==void 0&&e.set(t.pieces,t.sq);return e}var X={_init(){},_update(e){},_render(){},next_scene(){}},Z,Q;function $(e){Q._destroy?.(),Q=e}var Re={simulate:I};function ze(){Z=X,Q=Z,$(I)}function Be(e){Q!==Z&&(Z=Q,Z._init()),Z._update(e);let t=Z.next_scene();t!==void 0&&$(Re[t]),a.update(e)}function Ve(){Z._render()}function He(){Z._after_render?.()}async function Ue(e){let t=s(),r=document.createElement(`div`);t.classList.add(`interactive`),r.classList.add(`content`),r.appendChild(t),e.appendChild(r),ze(),n(Be,Ve,He)}Ue(document.getElementById(`app`));